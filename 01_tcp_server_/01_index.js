// π”· TCP SERVER λ§λ“¤κΈ° (node.js λ΅)


// π”· λ‚΄μ¥ λ¨λ“λ΅ μ‚¬μ©ν•  κ±΄, net μ„! 
    // net μ‚¬μ©ν•λ©΄ > tcp μ†μΌ“μ„ λ§λ“¤μ–΄μ„, μ‚¬μ©ν•  μ μμ. 
    // tcp μ—°κ²°μ„ λ§Ίμ–΄μ£Όλ”, ν”„λ΅ν† μ½
    // tcp μ†μΌ“μ„ μƒμ„±ν•κ³ , β­μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ κ°„, μ‘λ‹µ μ”μ²­β­μ„ λ§Ίμ„ μ μλ‹¤. 



    // λ‚΄μ¥λ¨λ“ net μ„ κ°€μ Έμ¨λ‹¤.
    const net = require("net")

    const PORT = 4000;

    // μ„λ²„ κ°μ²΄λ¥Ό μƒμ„± 
        // createServer λ©”μ†λ“ μ‚¬μ©
        // λ©”μ†λ“λ΅ μ½λ°± ν•¨μλ¥Ό μ „λ‹¬
    const server = net.createServer( (client, ) => {
        // ν΄λΌκ°€ μ΄ μ„λ²„μ— μ—°κ²°μ΄ λλ©΄ > μ΄ callback ν•¨μκ°€ μ‹¤ν–‰ 

        // ν΄λΌμ΄μ–ΈνΈκ°€ λ°μ΄ν„°λ¥Ό λ³΄λ‚΄μ„, μ„λ²„μ—μ„ λ°μ΄ν„°λ¥Ό λ°›μΌλ©΄, μ–΄λ–»κ² ν•μ§€? > μ„λ²„κ°€ μ‘λ‹µν•΄μ¤μ•Ό κ² μ§€ 
        client.on('data', (data) => {
            // ν΄λΌμ΄μ–ΈνΈκ°€ λ³΄λ‚Έ λ°μ΄ν„° 
            // μ΄λ²¤νΈμ— μ½λ°±ν•¨μλ¥Ό λ„£μ–΄λ‘  
            // ν΄λΌκ°€ data κ°€ λλ©΄ > μ‹¤ν–‰λλ‹¤. 
            // λ„¤νΈμ›ν¬λ¥Ό ν†µν•΄ μ „μ†΅λλ” λ°μ΄ν„° 
            
            console.log(data);
                // μ¦‰, ν΄λΌμ΄μ–ΈνΈκ°€ λ³΄λ‚Έ λ°μ΄ν„°λ” <Buffer μ ν•νƒ, binary ν•νƒλ΅, μ „μ†΅μ΄ λλ©°, μ„λ²„λ”, μ΄λ¬ν• binary λ°μ΄ν„°λ¥Ό λ°›μ•„μ„, ν•΄μ„ ν•΄μ„, λ¬Έμμ—΄λ΅ λ³€ν™ν•λ©΄ λλ‹¤.>
                
            console.log(JSON.stringify(data))
            console.log(data.tostring());

            // header μ λ‚΄μ©μ΄ λ‚μ΄ 
                // μ”μ²­μ„ ν–μ„ λ• μ”μ²­μ— λ€ν• μ •λ³΄μ„. 

            // κ·Έ λ‹¤μ body μ λ‚΄μ©



        })
        
    })
    // [ν•΄μ„]
        // TCPμ λ‚΄μ©μ„ λ§λ“¤μ–΄μ¤¬μ
        
        // ν¬λΌμ΄μ–ΈνΈκ°€ μ ‘μ†ν•λ©΄ > socket μ΄ λ§λ“¤μ–΄μ§€κ³  > client μ™€ socket μ΄ μ£Όκ³ λ°›μΌλ©΄μ„, μ—°κ²°μ΄ λλ‹¤. 
        
    // λ§λ“  μ„λ²„κ°€ λ€κΈ° μƒνƒλ΅, μ‘λ‹µμ„ κΈ°λ‹¤λ¦΄ μ μκ² ν•΄μ¤μ•Ό ν•¨
    server.listen(PORT, () => {
        console.log('μ„λ²„ μ μ—΄λ Έμ!');
    })

        // node νμΌ κ²½λ΅
        // C:\Users\user11\Desktop\kga\week01\230428>node 01_index.js

        // localhost μ— λ“¤μ–΄κ°€λ©΄ μ΄κ² λ‚μ΄ 
            // <Buffer 47 45 54 20 2f 20 48 54 54 50 2f 31 2e 31 0d 0a 48 6f 73 74 3a 20 6c 6f 63 61 6c 68 6f 73 74 3a 34 30 30 30 0d 0a 43 6f 6e 6e 65 63 74 69 6f 6e 3a 20 ... 629 more bytes>
            // μ™? 
            // λ°μ΄ν„°λ¥Ό 'λ°”μ΄λ„λ¦¬ ν•μ‹' μΌλ΅ μ „μ†΅ν•¨

            // μ¦‰, ν΄λΌμ΄μ–ΈνΈκ°€ λ³΄λ‚Έ λ°μ΄ν„°λ” <Buffer μ ν•νƒ, binary ν•νƒλ΅, μ „μ†΅μ΄ λλ©°, μ„λ²„λ”, μ΄λ¬ν• binary λ°μ΄ν„°λ¥Ό λ°›μ•„μ„, ν•΄μ„ ν•΄μ„, λ¬Έμμ—΄λ΅ λ³€ν™ν•λ©΄ λλ‹¤.>
            // μ¶λ ¥λ λ°μ΄ν„°λ” buffer ν•μ‹(λ°”μ΄λ„λ¦¬ν•μ‹) μΌλ΅ μΈμ½”λ”© ν•΄μ„, λ°μ΄ν„° μ²λΌ λ³΄λ‚΄λ” κ²ƒ. 
            console.log(JSON.stringify(data))
                // ν΄λΌλ” buffer ν•μ‹(binary ν•μ‹)μΌλ΅ λ³΄λ‚Έλ‹¤. 
                // μ„λ²„λ” λ³€ν™(JSON.stringify(data)) (κ°μ²΄λ¥Ό μ¤νΈλ§ νμ΄λ΅)ν•΄μ„ λ³΄μ΄κ² ν•λ‹¤. 